import{c as v,j as e,r as a}from"./chunks/client-57c61f85.js";function g(){chrome.runtime.openOptionsPage?chrome.runtime.openOptionsPage():window.open(chrome.runtime.getURL("options.html"))}const S=()=>{const[d,h]=a.useState(5),[r,i]=a.useState(!1),[c,o]=a.useState(null),[b,p]=a.useState([]),[f,x]=a.useState(!1);a.useEffect(()=>{chrome.storage.local.get(["botLog","openaiApiKey"],s=>{p(s.botLog||[]),s.openaiApiKey||x(!0)});const t=(s,n)=>{n==="local"&&s.botLog&&p(s.botLog.newValue||[])};return chrome.storage.onChanged.addListener(t),()=>chrome.storage.onChanged.removeListener(t)},[]);const l=(t,s)=>new Promise((n,m)=>{chrome.tabs.sendMessage(t,s,j=>{chrome.runtime.lastError?m(new Error(chrome.runtime.lastError.message)):n(j)})}),u=async()=>{const t=await chrome.windows.getLastFocused({windowTypes:["normal"]}),n=(await chrome.tabs.query({active:!0,windowId:t.id}))[0];if(!(n!=null&&n.id))throw new Error("No active tab");return{id:n.id,url:n.url||"unknown"}};async function w(){o(null),i(!0);try{const{id:t,url:s}=await u();if(await l(t,{type:"PING_TEST"})!=="âœ… Content script active!"){o(`âŒ Please make sure youâ€™re on a LinkedIn Messaging page. Current URL: ${s}`),i(!1);return}(await l(t,{type:"START_BOT",n:d+1})).status==="ok"?o("âœ… Bot started"):(o("âŒ Failed to start bot"),i(!1))}catch(t){const s=t.message||"";s.includes("No active tab")?o("âŒ No active tab found"):o(`âŒ ${s}`),i(!1)}}async function y(){o(null);try{const{id:t}=await u();(await l(t,{type:"STOP_BOT"})).status==="stopped"?(o("ðŸ›‘ Bot stopped"),i(!1)):o("âŒ Failed to stop bot")}catch(t){const s=t.message||"";s.includes("No active tab")?o("âŒ No active tab found"):o(`âŒ ${s}`)}}return e.jsxs("div",{className:"popup-root",children:[e.jsxs("div",{className:"popup-header",children:[e.jsx("span",{className:"popup-title",children:"Auto-Reply"}),e.jsx("button",{className:"popup-close",title:"Close",onClick:()=>window.close(),children:"Ã—"})]}),f&&e.jsxs("div",{style:{background:"#f8e6c1",padding:12,marginBottom:10,borderRadius:8},children:[e.jsx("b",{children:"Welcome!"})," Set your OpenAI API key in Settings first."]}),e.jsxs("div",{style:{margin:"10px 0 16px 0",display:"flex",alignItems:"center",gap:10},children:[e.jsx("label",{htmlFor:"num-chats",style:{fontSize:13},children:"Chats to Process:"}),e.jsx("input",{id:"num-chats",type:"number",value:d,min:1,max:50,style:{width:60,padding:"3px 5px",borderRadius:6,border:"1px solid #c6d0e4"},onChange:t=>h(Number(t.target.value))})]}),e.jsxs("div",{className:"button-row",children:[e.jsx("button",{disabled:r,onClick:w,children:r?"Running...":"Run Bot"}),e.jsx("button",{disabled:!r,onClick:y,style:{background:"#c62828",marginLeft:8},children:"Stop"}),e.jsx("button",{onClick:g,style:{background:"#f2f6fa",color:"#0a66c2",border:"1px solid #bcdffb",marginLeft:8},children:"Settings"})]}),c&&e.jsx("div",{style:{textAlign:"center",fontSize:13,color:c.startsWith("âœ…")?"#2e7d32":"#c62828"},children:c}),e.jsxs("div",{className:"popup-note",children:["Tip: Set your API key and prompt in ",e.jsx("span",{className:"popup-link",onClick:g,children:"Settings"}),"."]}),e.jsxs("div",{className:"popup-note",children:["For more details, visit our"," ",e.jsx("a",{className:"popup-link",href:"https://www.airesponder.xyz/",target:"_blank",rel:"noopener noreferrer",children:"Website"}),"."]}),e.jsxs("div",{style:{fontSize:13,color:"#888",marginTop:20,maxHeight:150,overflowY:"auto"},children:[e.jsx("b",{children:"Recent log:"}),e.jsx("ul",{children:b.slice(0,5).map((t,s)=>e.jsxs("li",{children:[new Date(t.time).toLocaleTimeString()," â€“ ",t.type,t.detail?": "+JSON.stringify(t.detail):""]},s))})]})]})},k=v(document.getElementById("popup-root"));k.render(e.jsx(S,{}));
