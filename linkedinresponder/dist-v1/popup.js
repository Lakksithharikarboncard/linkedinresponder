import{c as ue,j as e,r as a}from"./chunks/client-CTQ0Ju4c.js";const me=1e3,he=15e3,U=60,ge=()=>{const[t,o]=a.useState(!1),[d,x]=a.useState(!1),[i,D]=a.useState({chatsProcessed:0,repliesSent:0,leadsFound:0,startTime:null,tokensUsed:0,currentModel:""}),[j,F]=a.useState([]),[V,b]=a.useState(!0),[z,R]=a.useState(!1),[h,q]=a.useState(null),[G,O]=a.useState(!1),[f,L]=a.useState({conversationCount:0,totalMessages:0}),[I,J]=a.useState(10),[k,m]=a.useState(null),[N,H]=a.useState(!1),[w,T]=a.useState(null),[_,S]=a.useState(""),[W,Y]=a.useState(0),M=a.useRef(null),C=a.useRef(!0),E=a.useRef(null),P=a.useRef(null),K=s=>!!s&&/https:\/\/(www\.)?linkedin\.com\/messaging/i.test(s),g=async s=>{const l=(await chrome.tabs.query({active:!0,currentWindow:!0}))[0];return!(l!=null&&l.id)||!K(l.url)?(m("Open LinkedIn Messaging and try again"),null):new Promise(n=>{chrome.tabs.sendMessage(l.id,s,c=>{chrome.runtime.lastError?(m("Content script not detected. Refresh LinkedIn Messaging."),n(null)):n(c)})})},A=()=>{chrome.storage.local.get(["conversation_histories"],s=>{const r=s.conversation_histories||{},l=Object.keys(r).length,n=Object.values(r).reduce((c,u)=>{var v;return c+(((v=u.messages)==null?void 0:v.length)||0)},0);L({conversationCount:l,totalMessages:n})})};a.useEffect(()=>{chrome.storage.local.get(["replyPreviewEnabled"],n=>{n.replyPreviewEnabled!==void 0&&H(n.replyPreviewEnabled)});const s=(n,c)=>{if(c==="local"){if(n.conversation_histories){const u=n.conversation_histories.newValue||{},v=Object.keys(u).length,ie=Object.values(u).reduce((ce,de)=>{var B;return ce+(((B=de.messages)==null?void 0:B.length)||0)},0);L({conversationCount:v,totalMessages:ie})}if(n.pendingReply){const u=n.pendingReply.newValue;u&&N&&(T(u),S(u.reply))}}};chrome.storage.onChanged.addListener(s);const r=async()=>{try{const n=await g({type:"GET_STATUS"});n?(o(n.running),D(n.stats),F(c=>{if(c.length!==n.logs.length)return n.logs;if(c.length>0&&n.logs.length>0){const u=c[0],v=n.logs[0];if(u.time!==v.time||u.message!==v.message)return n.logs}return c}),m(null)):m("Navigate to LinkedIn Messaging")}catch{m("Connect to LinkedIn Messaging")}finally{b(!1)}};r(),A(),E.current=window.setInterval(r,me),P.current=window.setInterval(A,he);const l=window.setInterval(()=>{Y(n=>n+1)},1e3);return()=>{E.current!==null&&window.clearInterval(E.current),P.current!==null&&window.clearInterval(P.current),window.clearInterval(l),chrome.storage.onChanged.removeListener(s)}},[N]),a.useEffect(()=>{const s=M.current;if(!s)return;const r=()=>{const n=s.scrollHeight-s.scrollTop-s.clientHeight;C.current=n<U},l=()=>{s.scrollHeight-s.scrollTop-s.clientHeight>U&&(C.current=!1)};return s.addEventListener("scroll",r,{passive:!0}),s.addEventListener("mousedown",l,{passive:!0}),()=>{s.removeEventListener("scroll",r),s.removeEventListener("mousedown",l)}},[]),a.useEffect(()=>{const s=M.current;s&&C.current&&requestAnimationFrame(()=>{C.current&&(s.scrollTop=s.scrollHeight)})},[j]);const X=s=>{H(s),chrome.storage.local.set({replyPreviewEnabled:s})},Q=async()=>{b(!0);try{const s=await g({type:"START_BOT",config:{nChats:I,replyPreviewEnabled:N}});s&&s.status==="ok"?(o(!0),x(!1),m(null)):s&&m(s.error||"Unable to start")}finally{b(!1)}},Z=async()=>{await g({type:"PAUSE_BOT"}),x(!0)},ee=async()=>{await g({type:"RESUME_BOT"}),x(!1)},se=async()=>{b(!0),await g({type:"STOP_BOT"});const s=i.startTime?Date.now()-i.startTime:0,r=Math.floor(s/6e4),l=Math.floor(s%6e4/1e3);q({duration:`${r}m ${l}s`,processed:i.chatsProcessed,replied:i.repliesSent,skipped:i.chatsProcessed-i.repliesSent,leads:i.leadsFound,tokens:i.tokensUsed,model:i.currentModel||"Unknown"}),o(!1),x(!1),b(!1),R(!0)},te=async()=>{w&&(await g({type:"APPROVE_REPLY",reply:_,leadName:w.leadName}),T(null),S(""),chrome.storage.local.remove(["pendingReply"]))},$=async()=>{w&&(await g({type:"REJECT_REPLY",leadName:w.leadName}),T(null),S(""),chrome.storage.local.remove(["pendingReply"]))},ne=()=>{chrome.storage.local.get(["conversation_histories"],s=>{const r=s.conversation_histories||{},l=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),n=URL.createObjectURL(l),c=document.createElement("a");c.href=n,c.download=`linkedin-conversations-${new Date().toISOString().slice(0,10)}.json`,c.click(),URL.revokeObjectURL(n)})},ae=()=>{const s=j.map(r=>`[${new Date(r.time).toLocaleTimeString([],{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}] ${r.actor}: ${r.message}`).join(`
`);navigator.clipboard.writeText(s).then(()=>{O(!0),setTimeout(()=>O(!1),2e3)}).catch(()=>{m("Clipboard copy failed"),setTimeout(()=>m(null),2500)})},le=()=>{confirm(`Clear ${f.conversationCount} conversation histories?

This cannot be undone.`)&&chrome.storage.local.set({conversation_histories:{}},()=>{L({conversationCount:0,totalMessages:0})})},oe=()=>{chrome.runtime.openOptionsPage?chrome.runtime.openOptionsPage():window.open(chrome.runtime.getURL("options.html"))},re=a.useMemo(()=>{if(!i.startTime)return"â€”";const s=Math.max(0,Math.floor((Date.now()-i.startTime)/1e3)),r=String(Math.floor(s/60)).padStart(2,"0"),l=String(s%60).padStart(2,"0");return`${r}:${l}`},[i.startTime,W]);return V?e.jsxs("div",{className:"loading-screen",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("div",{className:"loading-text",children:"Loading..."})]}):e.jsxs("div",{className:"popup-root",children:[w&&e.jsx("div",{className:"modal-overlay",onClick:s=>s.target===s.currentTarget&&$(),children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("h2",{className:"modal-title",children:["ðŸ“ Review Reply to ",w.leadName]}),e.jsx("textarea",{className:"modal-textarea",value:_,onChange:s=>S(s.target.value)}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"btn-secondary",onClick:$,children:"âœ• Skip"}),e.jsx("button",{className:"btn-primary",onClick:te,children:"âœ“ Send"})]})]})}),z&&h&&e.jsx("div",{className:"modal-overlay",onClick:()=>R(!1),children:e.jsxs("div",{className:"modal-content",onClick:s=>s.stopPropagation(),children:[e.jsx("h2",{className:"modal-title",children:"âœ… Session Complete"}),e.jsxs("div",{className:"summary-grid",children:[e.jsx(p,{label:"Duration",value:h.duration,valueColor:"#173a35"}),e.jsx(p,{label:"Processed",value:h.processed,valueColor:"#008585"}),e.jsx(p,{label:"Replied",value:h.replied,valueColor:"#74a892"}),e.jsx(p,{label:"Skipped",value:h.skipped,valueColor:"#6c757d"}),e.jsx(p,{label:"Leads Found",value:h.leads,valueColor:"#c7522a"}),e.jsx(p,{label:"Tokens Used",value:h.tokens.toLocaleString(),valueColor:"#173a35"}),e.jsx(p,{label:"Model",value:h.model,valueColor:"#173a35",small:!0})]}),e.jsx("button",{className:"btn-primary",onClick:()=>R(!1),children:"Close"})]})}),e.jsxs("div",{className:"header",children:[e.jsxs("div",{className:"header-content",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("div",{className:"header-icon",children:e.jsx(ve,{size:18,color:"white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"header-title",children:"LinkedIn Autoresponder"}),e.jsx("div",{className:"header-subtitle",children:"Human-like AI agent"})]})]}),e.jsxs("div",{className:"header-right",children:[e.jsx("div",{className:`status-badge ${t?d?"paused":"running":"idle"}`,children:t?d?"âšâš Paused":"â— Running":"â—‹ Idle"}),e.jsxs("div",{className:"header-uptime",children:["â± ",re]})]})]}),k&&e.jsxs("div",{className:"error-banner",children:["âš ï¸ ",k]})]}),e.jsxs("div",{className:"content",children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx(pe,{size:16,color:"#173a35"}),e.jsx("span",{className:"card-title",children:"Stats"}),e.jsx("span",{className:"live-indicator",children:"â— Live"})]}),e.jsxs("div",{className:"stats-grid",children:[e.jsx(y,{label:"processed",value:i.chatsProcessed,color:"#008585"}),e.jsx(y,{label:"replied",value:i.repliesSent,color:"#74a892"}),e.jsx(y,{label:"leads",value:i.leadsFound,color:"#c7522a"}),e.jsx(y,{label:"convos",value:f.conversationCount,color:"#173a35"}),e.jsx(y,{label:"msgs",value:f.totalMessages,color:"#173a35"})]}),i.currentModel&&e.jsxs("div",{className:"model-info",children:["Model: ",e.jsx("strong",{children:i.currentModel})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx(xe,{size:16,color:"#173a35"}),e.jsx("span",{className:"card-title",children:"Controls"})]}),e.jsxs("div",{className:"controls-grid",children:[e.jsxs("div",{className:"field-group",children:[e.jsx("label",{className:"field-label",children:"Target chats"}),e.jsx("input",{type:"number",min:1,max:50,value:I,onChange:s=>J(Number(s.target.value)),disabled:t,className:"number-input"})]}),e.jsxs("div",{className:"field-group",children:[e.jsx("label",{className:"field-label",children:"Reply preview"}),e.jsx(be,{enabled:N,disabled:t,onToggle:()=>!t&&X(!N)})]})]}),e.jsxs("div",{className:"button-row",children:[e.jsx("button",{className:"btn-secondary",onClick:oe,children:"âš™ï¸ Settings"}),t?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:`btn-secondary ${d?"btn-resume":""}`,onClick:d?ee:Z,children:d?"â–¶":"âšâš"}),e.jsx("button",{className:"btn-stop",onClick:se,children:"â–  Stop"})]}):e.jsx("button",{className:"btn-primary btn-start",onClick:Q,disabled:!!k,children:"â–¶ Start"})]}),e.jsxs("div",{className:"button-row utility-row",children:[e.jsxs("button",{className:"btn-utility",onClick:ne,disabled:t||f.conversationCount===0,children:[e.jsx(fe,{size:14,color:"currentColor"}),"Export"]}),e.jsxs("button",{className:"btn-utility",onClick:le,disabled:t||f.conversationCount===0,children:[e.jsx(we,{size:14,color:"currentColor"}),"Clear (",f.conversationCount,")"]})]})]}),e.jsxs("div",{className:"terminal",children:[e.jsxs("div",{className:"terminal-header",children:[e.jsxs("div",{className:"terminal-title",children:[e.jsx(je,{size:14,color:"#74a892"}),e.jsx("span",{children:"Live Terminal"})]}),e.jsxs("div",{className:"terminal-actions",children:[e.jsx("button",{className:"terminal-btn",onClick:ae,disabled:j.length===0,children:G?"âœ“":"Copy"}),e.jsx("span",{className:"log-count",children:j.length})]})]}),e.jsxs("div",{ref:M,className:"log-container",children:[j.length===0&&e.jsx("div",{className:"log-empty",children:"Ready."}),j.map((s,r)=>{const l=s.message.includes("Double-texting")||s.message.includes("double-text"),n=s.message.includes("(")&&s.message.includes("@"),c=s.message.includes("Saved")&&s.message.includes("messages");return e.jsxs("div",{className:"log-entry",children:[e.jsx("span",{className:"log-time",children:new Date(s.time).toLocaleTimeString([],{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}),e.jsx("span",{className:`log-actor actor-${s.actor.toLowerCase()}`,children:s.actor}),e.jsxs("span",{className:`log-message ${s.type==="ERROR"?"error":""} ${l?"double-text":""} ${c?"storage":""}`,children:[l&&"ðŸ’¬ ",n&&"ðŸ‘¤ ",c&&"ðŸ’¾ ",s.message]})]},r)})]})]}),e.jsx("div",{className:"footer-version",children:"v2.8.0 â€¢ LinkedIn Autoresponder"})]})]})};function ve({size:t=16,color:o="#000"}){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",stroke:o,strokeWidth:"2",fill:"none"})})}function pe({size:t=16,color:o="#000"}){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{fill:o,d:"M13 3a2 2 0 0 1 1.995 1.85L15 5v16H9V5a2 2 0 0 1 1.85-1.995L11 3zm7 5a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-3V8zM7 11v10H4a2 2 0 0 1-2-2v-6a2 2 0 0 1 2-2z"})})}function xe({size:t=16,color:o="#000"}){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{fill:o,d:"M16 15c1.306 0 2.418.835 2.83 2H20a1 1 0 1 1 0 2h-1.17a3.001 3.001 0 0 1-5.66 0H4a1 1 0 1 1 0-2h9.17A3.001 3.001 0 0 1 16 15M8 9a3 3 0 0 1 2.762 1.828l.067.172H20a1 1 0 0 1 .117 1.993L20 13h-9.17a3.001 3.001 0 0 1-5.592.172L5.17 13H4a1 1 0 0 1-.117-1.993L4 11h1.17A3.001 3.001 0 0 1 8 9m8-6c1.306 0 2.418.835 2.83 2H20a1 1 0 1 1 0 2h-1.17a3.001 3.001 0 0 1-5.66 0H4a1 1 0 0 1 0-2h9.17A3.001 3.001 0 0 1 16 3"})})}function je({size:t=16,color:o="#000"}){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{fill:o,fillRule:"evenodd",d:"M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2zm-3 11h-2a1 1 0 1 0 0 2h2a1 1 0 1 0 0-2M9.05 8.465a1 1 0 0 0-1.497 1.32l.083.094L9.757 12l-2.12 2.121a1 1 0 0 0 1.32 1.498l.093-.083 2.829-2.829a1 1 0 0 0 .083-1.32l-.083-.094z"})})}function fe({size:t=14,color:o="#000"}){return e.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:o,children:e.jsx("path",{d:"M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2v9.67z"})})}function we({size:t=14,color:o="#000"}){return e.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:o,children:e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})}function y({label:t,value:o,color:d}){return e.jsxs("div",{className:"stat-item",children:[e.jsx("div",{className:"stat-value",style:{color:d},children:o}),e.jsx("div",{className:"stat-label",children:t})]})}function be({enabled:t,disabled:o,onToggle:d}){return e.jsxs("div",{className:`toggle-switch ${t?"enabled":""} ${o?"disabled":""}`,onClick:d,children:[e.jsx("div",{className:"toggle-track",children:e.jsx("div",{className:"toggle-thumb"})}),e.jsx("span",{className:"toggle-label",children:t?"On":"Off"})]})}function p({label:t,value:o,valueColor:d,small:x}){return e.jsxs("div",{className:"summary-row",children:[e.jsxs("span",{className:"summary-label",children:[t,":"]}),e.jsx("span",{className:`summary-value ${x?"small":""}`,style:{color:d},children:o})]})}const Ne=ue(document.getElementById("popup-root"));Ne.render(e.jsx(ge,{}));
