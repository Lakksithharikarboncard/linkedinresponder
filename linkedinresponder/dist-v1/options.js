import{c as K,j as e,r as c}from"./chunks/client-CTQ0Ju4c.js";import{D as v,g as U,s as L}from"./chunks/settings-BoqPDAdz.js";const F=()=>{const[s,r]=c.useState(v),[y,k]=c.useState(v),[g,h]=c.useState("idle"),[f,d]=c.useState(null),[u,C]=c.useState(!1),[m,S]=c.useState(!1),[A,x]=c.useState({openai:"idle",groq:"idle"}),[P,p]=c.useState({openai:"",groq:""}),w=c.useRef(null);c.useEffect(()=>{(async()=>{try{const a=await U();r(a),k(a)}catch{d("Failed to load settings")}})(),chrome.storage.local.get(["darkMode"],a=>{a.darkMode!==void 0&&C(a.darkMode)})},[]),c.useEffect(()=>{S(JSON.stringify(s)!==JSON.stringify(y))},[s,y]),c.useEffect(()=>{document.documentElement.setAttribute("data-theme",u?"dark":"light"),chrome.storage.local.set({darkMode:u})},[u]);const t=(a,n)=>r(i=>({...i,[a]:n})),R=async()=>{if(d(null),h("saving"),s.endHour<=s.startHour){h("error"),d("End hour must be after start hour");return}if(!s.openaiApiKey.trim()){h("error"),d("OpenAI API key is required");return}if(!s.groqApiKey.trim()){h("error"),d("Groq API key is required");return}try{await L(s),k(s),h("saved"),S(!1),setTimeout(()=>h("idle"),1800)}catch{h("error"),d("Failed to save settings")}},E=()=>{confirm(`Reset all settings to defaults?

This cannot be undone.`)&&r(v)},T=a=>{var l;const n=(l=a.target.files)==null?void 0:l[0];if(!n)return;const i=new FileReader;i.onload=o=>{var q;try{const H=JSON.parse((q=o.target)==null?void 0:q.result);H.settings?(r({...v,...H.settings}),d(null)):d("Invalid settings file")}catch{d("Failed to parse settings file")}},i.readAsText(n),a.target.value=""},O=()=>{const a={settings:s,exportedAt:new Date().toISOString(),version:"2.7.0"},n=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),i=URL.createObjectURL(n),l=document.createElement("a");l.href=i,l.download=`linkedin-autoresponder-settings-${new Date().toISOString().slice(0,10)}.json`,l.click(),URL.revokeObjectURL(i)},M=async a=>{const i={openai:s.openaiApiKey,groq:s.groqApiKey}[a];if(x(l=>({...l,[a]:"testing"})),p(l=>({...l,[a]:""})),!(i!=null&&i.trim())){x(l=>({...l,[a]:"error"})),p(l=>({...l,[a]:"Key is empty"}));return}try{const l=await chrome.runtime.sendMessage({type:"TEST_API_KEY",provider:a,key:i});l!=null&&l.success?(x(o=>({...o,[a]:"success"})),p(o=>({...o,[a]:l.message}))):(x(o=>({...o,[a]:"error"})),p(o=>({...o,[a]:(l==null?void 0:l.message)||"Test failed"})))}catch(l){x(o=>({...o,[a]:"error"})),p(o=>({...o,[a]:(l==null?void 0:l.message)||"Could not reach background script"}))}},j=a=>{const n=a>=12?"PM":"AM";return`${a%12||12}:00 ${n}`},_=s.endHour>s.startHour?`${j(s.startHour)} â€“ ${j(s.endHour)}`:"Invalid",D=a=>{t("replyProvider",a),t("decisionProvider",a),t("leadDetectionProvider",a)};return e.jsxs("div",{className:"options-shell",children:[e.jsxs("header",{className:"options-header",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("div",{className:"header-icon",children:"âš™ï¸"}),e.jsxs("div",{children:[e.jsx("h1",{children:"Settings"}),e.jsx("p",{children:"LinkedIn Autoresponder v2.7.0"})]})]}),e.jsxs("div",{className:"header-actions",children:[e.jsx("button",{className:"btn ghost",onClick:()=>{var a;return(a=w.current)==null?void 0:a.click()},children:"Import"}),e.jsx("input",{ref:w,type:"file",accept:".json",onChange:T,style:{display:"none"}}),e.jsx("button",{className:"btn ghost",onClick:O,children:"Export"}),e.jsx("button",{className:"btn ghost",onClick:E,children:"Reset"}),e.jsx("button",{className:"btn ghost",onClick:()=>C(!u),children:u?"â˜€ï¸":"ðŸŒ™"})]})]}),f&&e.jsxs("div",{className:"banner error",children:["âš ï¸ ",f]}),m&&!f&&e.jsx("div",{className:"banner warn",children:"You have unsaved changes"}),e.jsxs("div",{className:"grid",children:[e.jsxs("section",{className:"card wide",children:[e.jsx("div",{className:"card-header",children:"API Keys"}),e.jsxs("div",{className:"card-body two-col",children:[e.jsx(I,{label:"OpenAI API Key",value:s.openaiApiKey,onChange:a=>t("openaiApiKey",a),placeholder:"sk-...",status:A.openai,message:P.openai,onTest:()=>M("openai")}),e.jsx(I,{label:"Groq API Key",value:s.groqApiKey,onChange:a=>t("groqApiKey",a),placeholder:"gsk_...",status:A.groq,message:P.groq,onTest:()=>M("groq")})]})]}),e.jsxs("section",{className:"card wide",children:[e.jsx("div",{className:"card-header",children:"AI Provider Selection"}),e.jsxs("div",{className:"card-body three-col",children:[e.jsx(N,{label:"Reply Generation",description:"Generates chat responses",value:s.replyProvider,onChange:a=>t("replyProvider",a)}),e.jsx(N,{label:"Reply Decision",description:"Decides if bot should reply",value:s.decisionProvider,onChange:a=>t("decisionProvider",a)}),e.jsx(N,{label:"Lead Detection",description:"Identifies qualified leads",value:s.leadDetectionProvider,onChange:a=>t("leadDetectionProvider",a)})]}),e.jsxs("div",{className:"quick-row",children:[e.jsx("button",{onClick:()=>D("groq"),children:"All Groq"}),e.jsx("button",{onClick:()=>D("openai"),children:"All OpenAI"}),e.jsx("button",{onClick:()=>{t("replyProvider","groq"),t("decisionProvider","groq"),t("leadDetectionProvider","openai")},children:"Recommended"})]}),e.jsxs("p",{className:"muted",style:{marginTop:"8px"},children:["ðŸ’¡ ",e.jsx("strong",{children:"Recommended:"})," Groq for replies & decisions (fast, cheap), OpenAI for lead detection (accurate)."]})]}),e.jsxs("section",{className:"card wide",children:[e.jsx("div",{className:"card-header",children:"Lead Notifications"}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"field-block",children:[e.jsx("label",{className:"field-label",children:"Zapier Webhook URL"}),e.jsx("input",{type:"url",value:s.webhookUrl,onChange:a=>t("webhookUrl",a.target.value),placeholder:"https://hooks.zapier.com/hooks/catch/..."}),e.jsx("span",{className:"muted",children:"When a lead is detected, JSON data will be sent to this webhook."})]}),s.webhookUrl&&e.jsxs("div",{className:"webhook-preview",children:[e.jsx("p",{className:"field-label",style:{marginBottom:"8px"},children:"Payload Preview:"}),e.jsx("pre",{className:"code-block",children:`{
  "leadName": "John Smith",
  "profileUrl": "https://linkedin.com/in/...",
  "company": "Acme Corp",
  "jobTitle": "VP of Sales",
  "headline": "VP of Sales at Acme Corp",
  "conversationHistory": "...",
  "messageCount": 12,
  "detectedAt": "2025-01-03T19:42:00Z"
}`})]})]})]}),e.jsxs("section",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("span",{children:"Working Hours"}),e.jsx("span",{className:`pill ${s.endHour<=s.startHour?"pill-warn":""}`,children:_})]}),e.jsxs("div",{className:"card-body two-col",children:[e.jsxs("div",{className:"field-block",children:[e.jsx("label",{className:"field-label",children:"Start"}),e.jsx("select",{value:s.startHour,onChange:a=>t("startHour",Number(a.target.value)),children:Array.from({length:24},(a,n)=>e.jsx("option",{value:n,children:j(n)},n))})]}),e.jsxs("div",{className:"field-block",children:[e.jsx("label",{className:"field-label",children:"End"}),e.jsx("select",{value:s.endHour,onChange:a=>t("endHour",Number(a.target.value)),children:Array.from({length:24},(a,n)=>e.jsx("option",{value:n,children:j(n)},n))})]})]}),s.endHour<=s.startHour&&e.jsx("p",{className:"muted text-warn",children:"End time must be later than start time."}),e.jsxs("div",{className:"quick-row",children:[e.jsx("button",{onClick:()=>{t("startHour",9),t("endHour",17)},children:"Business"}),e.jsx("button",{onClick:()=>{t("startHour",8),t("endHour",20)},children:"Extended"}),e.jsx("button",{onClick:()=>{t("startHour",0),t("endHour",23)},children:"24/7"})]})]}),e.jsxs("section",{className:"card",children:[e.jsx("div",{className:"card-header",children:"Timing & Delays"}),e.jsxs("div",{className:"card-body two-col",children:[e.jsx(b,{label:"Chat Min (sec)",value:s.chatMinDelay/1e3,onChange:a=>t("chatMinDelay",a*1e3),min:.25,max:60,step:.25}),e.jsx(b,{label:"Chat Max (sec)",value:s.chatMaxDelay/1e3,onChange:a=>t("chatMaxDelay",a*1e3),min:.25,max:120,step:.25}),e.jsx(b,{label:"Loop Min (sec)",value:s.loopMinDelay/1e3,onChange:a=>t("loopMinDelay",a*1e3),min:1,max:600,step:1}),e.jsx(b,{label:"Loop Max (sec)",value:s.loopMaxDelay/1e3,onChange:a=>t("loopMaxDelay",a*1e3),min:1,max:600,step:1})]}),e.jsxs("div",{className:"quick-row",children:[e.jsx("button",{onClick:()=>{t("chatMinDelay",1e3),t("chatMaxDelay",2e3),t("loopMinDelay",5e3),t("loopMaxDelay",1e4)},children:"Fast"}),e.jsx("button",{onClick:()=>{t("chatMinDelay",2e3),t("chatMaxDelay",5e3),t("loopMinDelay",1e4),t("loopMaxDelay",3e4)},children:"Normal"}),e.jsx("button",{onClick:()=>{t("chatMinDelay",3e3),t("chatMaxDelay",8e3),t("loopMinDelay",3e4),t("loopMaxDelay",6e4)},children:"Human-like"})]})]}),e.jsxs("section",{className:"card wide",children:[e.jsx("div",{className:"card-header",children:"AI Prompts"}),e.jsxs("div",{className:"card-body two-col",children:[e.jsxs("div",{className:"field-block",children:[e.jsx("label",{className:"field-label",children:"Reply Prompt"}),e.jsx("textarea",{rows:5,value:s.replyPrompt,onChange:a=>t("replyPrompt",a.target.value)}),e.jsxs("div",{className:"chip-row",children:[e.jsx("span",{className:"chip-label",children:"Variables:"}),e.jsx("button",{className:"chip",onClick:()=>t("replyPrompt",s.replyPrompt+"{user_name}"),children:"{user_name}"}),e.jsx("button",{className:"chip",onClick:()=>t("replyPrompt",s.replyPrompt+"{extracted_text}"),children:"{extracted_text}"})]})]}),e.jsxs("div",{className:"field-block",children:[e.jsx("label",{className:"field-label",children:"Lead Detection Prompt"}),e.jsx("textarea",{rows:3,value:s.leadPrompt,onChange:a=>t("leadPrompt",a.target.value)})]})]}),e.jsxs("div",{className:"quick-row",children:[e.jsx("button",{onClick:()=>t("replyPrompt","You are {user_name}'s professional assistant. Reply briefly and helpfully to: {extracted_text}"),children:"Professional"}),e.jsx("button",{onClick:()=>t("replyPrompt","You are {user_name}. Reply casually and friendly to: {extracted_text}"),children:"Casual"}),e.jsx("button",{onClick:()=>t("replyPrompt","You are {user_name}, a sales professional. Reply with interest and ask qualifying questions to: {extracted_text}"),children:"Sales"})]})]})]}),e.jsxs("footer",{className:"options-footer",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[m&&e.jsx("span",{className:"unsaved-dot",children:"â—"}),e.jsx("span",{children:m?"Unsaved changes":"All changes saved"})]}),e.jsxs("div",{className:"footer-actions",children:[e.jsx("button",{className:"btn ghost",onClick:()=>r(y),disabled:!m,children:"Cancel"}),e.jsx("button",{className:`btn primary ${g==="saved"?"success":""}`,onClick:R,disabled:g==="saving"||!m,children:g==="saving"?"Saving...":g==="saved"?"âœ“ Saved":"Save Settings"})]})]})]})};function I(s){return e.jsxs("div",{className:"field-block",children:[e.jsx("label",{className:"field-label",children:s.label}),e.jsxs("div",{className:"row",children:[e.jsx("input",{type:"password",value:s.value,onChange:r=>s.onChange(r.target.value),placeholder:s.placeholder,style:{flex:1}}),e.jsx("button",{className:"btn ghost",onClick:s.onTest,disabled:!s.value||s.status==="testing",style:{whiteSpace:"nowrap"},children:s.status==="testing"?"...":"Test"}),e.jsx(G,{status:s.status})]}),s.message&&e.jsx("span",{className:`muted ${s.status==="error"?"text-warn":""}`,children:s.message})]})}function N(s){return e.jsxs("div",{className:"field-block",children:[e.jsx("label",{className:"field-label",children:s.label}),e.jsxs("select",{value:s.value,onChange:r=>s.onChange(r.target.value),children:[e.jsx("option",{value:"groq",children:"Groq (Fast)"}),e.jsx("option",{value:"openai",children:"OpenAI (Accurate)"})]}),e.jsx("span",{className:"muted",children:s.description})]})}function b(s){return e.jsxs("div",{className:"field-block",children:[e.jsx("label",{className:"field-label",children:s.label}),e.jsx("input",{type:"number",value:s.value,min:s.min,max:s.max,step:s.step,onChange:r=>s.onChange(Number(r.target.value))})]})}function G({status:s}){const r=s==="success"?"#74a892":s==="error"?"#c7522a":s==="testing"?"#e5c185":"#adb5bd";return e.jsx("span",{className:"status-dot",style:{background:r}})}const $=K(document.getElementById("options-root"));$.render(e.jsx(F,{}));
